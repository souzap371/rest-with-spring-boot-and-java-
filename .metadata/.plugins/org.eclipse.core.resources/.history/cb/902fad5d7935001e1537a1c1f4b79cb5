package br.ufrn.imd.solicitacaurn.cassi.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

import br.com.mkapi.cassi.domain.RedeCredenciadaFavoritos;

import org.springframework.data.jpa.repository.Query;

@Repository
public interface RedeCredenciadaFavoritosRepository extends JpaRepository<RedeCredenciadaFavoritos, String>{

    @Query(value="SELECT * FROM REDE_CREDENCIADA_FAVORITOS where id_rede_credenciada=?1 and id_usuario=?2",nativeQuery = true)
	RedeCredenciadaFavoritos verificaFavorito(Long idRedeCredenciada, Long idUsuario);

	@Query(value = "SELECT * FROM (\r\n"
	+ " SELECT row_number() OVER (ORDER BY rcf.prestador ASC) linha, rcf.*\r\n"
	+ " FROM REDE_CREDENCIADA_FAVORITOS rcf \r\n"
	+ " WHERE rcf.favorito=1 and rcf.id_usuario=?1 \r\n"
	+ ") WHERE linha BETWEEN (?2 + 1) AND (?2 + 10)", nativeQuery = true)
	List<RedeCredenciadaFavoritos> getFavoritosByUsuario(Long idUsuario, Integer offset);
	//Paginação: 10 itens por página.
}
