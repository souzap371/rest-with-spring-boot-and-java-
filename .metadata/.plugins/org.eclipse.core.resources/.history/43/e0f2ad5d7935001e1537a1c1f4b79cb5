package br.ufrn.imd.solicitacaurn.cassi.repository;

import java.util.List;

import javax.transaction.Transactional;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Modifying;
import org.springframework.stereotype.Repository;

import br.com.mkapi.cassi.domain.EspecialidadeCassi;

import org.springframework.data.jpa.repository.Query;


@Repository
public interface EspecialidadeCassiRepository extends JpaRepository<EspecialidadeCassi, Long> {
    @Query(value = "SELECT * FROM (SELECT * FROM ESPECIALIDADES_CASSI ec\r\n"
        + "WHERE UPPER(ec.NOME) LIKE UPPER('%' || ?1 || '%')\r\n"
        + "ORDER BY case when ec.NOME LIKE UPPER(?1 || '%') then 0 else 1 END, ec.NOME) WHERE rownum <= 100 ", nativeQuery = true)
    public List<EspecialidadeCassi> getEspecialidadeByNome(String term);

    @Transactional
	@Modifying
    @Query(value = "DELETE FROM ESPECIALIDADES_CASSI ec WHERE ec.id > 0", nativeQuery = true)
    public void deletarTodasEspecialidadesCassi();
    //Deleta todas as entradas da tabela de Especialidades Cassi.    
}
